"""new-end-types-hcr-sales

Revision ID: 30b0d81d7e13
Revises: 726050a7f1c9
Create Date: 2021-06-15 09:32:30.736697

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '30b0d81d7e13'
down_revision = '726050a7f1c9'
branch_labels = None
depends_on = None


def upgrade():
    connection = op.get_bind()
    connection.execute(
        """
            CREATE OR REPLACE FUNCTION public.f_hc_report_sales(report_id integer, initial_date character varying,  final_date character varying, org_id integer)
                RETURNS void
                LANGUAGE plpgsql
            AS
            $function$
            DECLARE
                _sql        text;
                _update_set text;
            BEGIN
            
                _update_set := 'UPDATE health_canada_report SET ';
            
                FOR _sql IN
                    SELECT FORMAT('%%1$s = %%2$s,', query.report_column, query.value)
                    FROM (SELECT LOWER('sales_' || province || '_' || report_section || '_' || column_section || '_' ||
                                       column_type) AS report_column,
                                 value
                          FROM (SELECT *
                                FROM (SELECT province,
                                             report_section,
                                             column_section,
                                             column_type,
                                             CASE
                                                 WHEN column_type = 'qty' THEN packaged_qty
                                                 WHEN column_type = 'value' THEN price
                                                 ELSE unpackaged_qty
                                                 END AS value
                                      FROM f_hcr_sales_data(org_id, initial_date, final_date)) t1
                                     --f_hcr_sales_data(1, '2021-06-01', '2021-06-30')) t1
            
                                UNION
            
                                (SELECT 'total' AS province,
                                        report_section,
                                        column_section,
                                        column_type,
                                        CASE
                                            WHEN column_type = 'qty' THEN COALESCE(SUM(packaged_qty), 0)
                                            WHEN column_type = 'value' THEN COALESCE(SUM(price), 0)
                                            ELSE COALESCE(SUM(unpackaged_qty), 0)
                                            END AS value
                                 FROM f_hcr_sales_data(org_id, initial_date, final_date)
                                     --f_hcr_sales_data(1, '2021-06-01', '2021-06-30')
                                 GROUP BY report_section, column_section, column_type)) r2) query
                    LOOP
                        _update_set := _update_set || CHR(10) || _sql;
                    END LOOP;
            
                IF LENGTH(_sql) > 1 THEN
                    _update_set := FORMAT(SUBSTRING(_update_set, 0, LENGTH(_update_set)) || ' WHERE id = %%1$s', report_id);
                    EXECUTE _update_set;
                END IF;
            END;
            
            $function$
            ;
        """
    )


def downgrade():
    connection = op.get_bind()
    connection.execute(
        """
            CREATE OR REPLACE FUNCTION public.f_hc_report_sales(report_id integer, initial_date character varying, final_date character varying, org_id integer)
             RETURNS void
             LANGUAGE plpgsql
            AS $function$
                BEGIN	
                        UPDATE health_canada_report
                        SET
                            -- distributor seeds
                            ab_distributor_seeds_amount = COALESCE(seeds_ab_nomedical_distributor,0),
                            bc_distributor_seeds_amount = COALESCE(seeds_bc_nomedical_distributor,0),
                            mb_distributor_seeds_amount = COALESCE(seeds_mb_nomedical_distributor,0),
                            nb_distributor_seeds_amount = COALESCE(seeds_nb_nomedical_distributor,0), 
                            nl_distributor_seeds_amount = COALESCE(seeds_nl_nomedical_distributor,0), 
                            ns_distributor_seeds_amount = COALESCE(seeds_ns_nomedical_distributor,0),
                            nt_distributor_seeds_amount = COALESCE(seeds_nt_nomedical_distributor,0),
                            nu_distributor_seeds_amount = COALESCE(seeds_nu_nomedical_distributor,0),
                            on_distributor_seeds_amount = COALESCE(seeds_on_nomedical_distributor,0),
                            pe_distributor_seeds_amount = COALESCE(seeds_pe_nomedical_distributor,0),
                            qc_distributor_seeds_amount = COALESCE(seeds_qc_nomedical_distributor,0), 
                            sk_distributor_seeds_amount = COALESCE(seeds_sk_nomedical_distributor,0), 
                            yt_distributor_seeds_amount = COALESCE(seeds_yt_nomedical_distributor,0), 
                            total_distributor_seeds_amount = COALESCE(seeds_total_nomedical_distributor,0),

                            ab_distributor_seeds_value = COALESCE(seeds_ab_nomedical_distributor_value,0),
                            bc_distributor_seeds_value = COALESCE(seeds_bc_nomedical_distributor_value,0),
                            mb_distributor_seeds_value = COALESCE(seeds_mb_nomedical_distributor_value,0),
                            nb_distributor_seeds_value = COALESCE(seeds_nb_nomedical_distributor_value,0), 
                            nl_distributor_seeds_value = COALESCE(seeds_nl_nomedical_distributor_value,0), 
                            ns_distributor_seeds_value = COALESCE(seeds_ns_nomedical_distributor_value,0),
                            nt_distributor_seeds_value = COALESCE(seeds_nt_nomedical_distributor_value,0),
                            nu_distributor_seeds_value = COALESCE(seeds_nu_nomedical_distributor_value,0),
                            on_distributor_seeds_value = COALESCE(seeds_on_nomedical_distributor_value,0),
                            pe_distributor_seeds_value = COALESCE(seeds_pe_nomedical_distributor_value,0),
                            qc_distributor_seeds_value = COALESCE(seeds_qc_nomedical_distributor_value,0), 
                            sk_distributor_seeds_value = COALESCE(seeds_sk_nomedical_distributor_value,0), 
                            yt_distributor_seeds_value = COALESCE(seeds_yt_nomedical_distributor_value,0), 
                            total_distributor_seeds_value = COALESCE(seeds_total_nomedical_distributor_value,0),
                            
                            
                            -- recreational consumer seeds
                            ab_recreational_consumer_seeds_amount = COALESCE(seeds_ab_nomedical_recreational_consumer,0),
                            bc_recreational_consumer_seeds_amount = COALESCE(seeds_bc_nomedical_recreational_consumer,0),
                            mb_recreational_consumer_seeds_amount = COALESCE(seeds_mb_nomedical_recreational_consumer,0),
                            nb_recreational_consumer_seeds_amount = COALESCE(seeds_nb_nomedical_recreational_consumer,0), 
                            nl_recreational_consumer_seeds_amount = COALESCE(seeds_nl_nomedical_recreational_consumer,0), 
                            ns_recreational_consumer_seeds_amount = COALESCE(seeds_ns_nomedical_recreational_consumer,0),
                            nt_recreational_consumer_seeds_amount = COALESCE(seeds_nt_nomedical_recreational_consumer,0),
                            nu_recreational_consumer_seeds_amount = COALESCE(seeds_nu_nomedical_recreational_consumer,0),
                            on_recreational_consumer_seeds_amount = COALESCE(seeds_on_nomedical_recreational_consumer,0),
                            pe_recreational_consumer_seeds_amount = COALESCE(seeds_pe_nomedical_recreational_consumer,0),
                            qc_recreational_consumer_seeds_amount = COALESCE(seeds_qc_nomedical_recreational_consumer,0), 
                            sk_recreational_consumer_seeds_amount = COALESCE(seeds_sk_nomedical_recreational_consumer,0), 
                            yt_recreational_consumer_seeds_amount = COALESCE(seeds_yt_nomedical_recreational_consumer,0), 
                            total_recreational_consumer_seeds_amount = COALESCE(seeds_total_nomedical_recreational_consumer,0),
                            
                            
                            ab_recreational_consumer_seeds_value = COALESCE(seeds_ab_nomedical_recreational_consumer_value,0),
                            bc_recreational_consumer_seeds_value = COALESCE(seeds_bc_nomedical_recreational_consumer_value,0),
                            mb_recreational_consumer_seeds_value = COALESCE(seeds_mb_nomedical_recreational_consumer_value,0),
                            nb_recreational_consumer_seeds_value = COALESCE(seeds_nb_nomedical_recreational_consumer_value,0), 
                            nl_recreational_consumer_seeds_value = COALESCE(seeds_nl_nomedical_recreational_consumer_value,0), 
                            ns_recreational_consumer_seeds_value = COALESCE(seeds_ns_nomedical_recreational_consumer_value,0),
                            nt_recreational_consumer_seeds_value = COALESCE(seeds_nt_nomedical_recreational_consumer_value,0),
                            nu_recreational_consumer_seeds_value = COALESCE(seeds_nu_nomedical_recreational_consumer_value,0),
                            on_recreational_consumer_seeds_value = COALESCE(seeds_on_nomedical_recreational_consumer_value,0),
                            pe_recreational_consumer_seeds_value = COALESCE(seeds_pe_nomedical_recreational_consumer_value,0),
                            qc_recreational_consumer_seeds_value = COALESCE(seeds_qc_nomedical_recreational_consumer_value,0), 
                            sk_recreational_consumer_seeds_value = COALESCE(seeds_sk_nomedical_recreational_consumer_value,0), 
                            yt_recreational_consumer_seeds_value = COALESCE(seeds_yt_nomedical_recreational_consumer_value,0), 
                            total_recreational_consumer_seeds_value = COALESCE(seeds_total_nomedical_recreational_consumer_value,0),

                            -- retailer seeds
                            ab_retailer_seeds_amount = COALESCE(seeds_ab_nomedical_retailer,0),
                            bc_retailer_seeds_amount = COALESCE(seeds_bc_nomedical_retailer,0),
                            mb_retailer_seeds_amount = COALESCE(seeds_mb_nomedical_retailer,0),
                            nb_retailer_seeds_amount = COALESCE(seeds_nb_nomedical_retailer,0), 
                            nl_retailer_seeds_amount = COALESCE(seeds_nl_nomedical_retailer,0), 
                            ns_retailer_seeds_amount = COALESCE(seeds_ns_nomedical_retailer,0),
                            nt_retailer_seeds_amount = COALESCE(seeds_nt_nomedical_retailer,0),
                            nu_retailer_seeds_amount = COALESCE(seeds_nu_nomedical_retailer,0),
                            on_retailer_seeds_amount = COALESCE(seeds_on_nomedical_retailer,0),
                            pe_retailer_seeds_amount = COALESCE(seeds_pe_nomedical_retailer,0),
                            qc_retailer_seeds_amount = COALESCE(seeds_qc_nomedical_retailer,0), 
                            sk_retailer_seeds_amount = COALESCE(seeds_sk_nomedical_retailer,0), 
                            yt_retailer_seeds_amount = COALESCE(seeds_yt_nomedical_retailer,0), 
                            total_retailer_seeds_amount = COALESCE(seeds_total_nomedical_retailer,0),
                            
                            ab_retailer_seeds_value = COALESCE(seeds_ab_nomedical_retailer_value,0),
                            bc_retailer_seeds_value = COALESCE(seeds_bc_nomedical_retailer_value,0),
                            mb_retailer_seeds_value = COALESCE(seeds_mb_nomedical_retailer_value,0),
                            nb_retailer_seeds_value = COALESCE(seeds_nb_nomedical_retailer_value,0), 
                            nl_retailer_seeds_value = COALESCE(seeds_nl_nomedical_retailer_value,0), 
                            ns_retailer_seeds_value = COALESCE(seeds_ns_nomedical_retailer_value,0),
                            nt_retailer_seeds_value = COALESCE(seeds_nt_nomedical_retailer_value,0),
                            nu_retailer_seeds_value = COALESCE(seeds_nu_nomedical_retailer_value,0),
                            on_retailer_seeds_value = COALESCE(seeds_on_nomedical_retailer_value,0),
                            pe_retailer_seeds_value = COALESCE(seeds_pe_nomedical_retailer_value,0),
                            qc_retailer_seeds_value = COALESCE(seeds_qc_nomedical_retailer_value,0), 
                            sk_retailer_seeds_value = COALESCE(seeds_sk_nomedical_retailer_value,0), 
                            yt_retailer_seeds_value = COALESCE(seeds_yt_nomedical_retailer_value,0), 
                            total_retailer_seeds_value = COALESCE(seeds_total_nomedical_retailer_value,0),

                            -- distributor plants
                            ab_distributor_veg_plants_amount = COALESCE(plants_ab_nomedical_distributor,0),
                            bc_distributor_veg_plants_amount = COALESCE(plants_bc_nomedical_distributor,0),
                            mb_distributor_veg_plants_amount = COALESCE(plants_mb_nomedical_distributor,0),
                            nb_distributor_veg_plants_amount = COALESCE(plants_nb_nomedical_distributor,0), 
                            nl_distributor_veg_plants_amount = COALESCE(plants_nl_nomedical_distributor,0), 
                            ns_distributor_veg_plants_amount = COALESCE(plants_ns_nomedical_distributor,0),
                            nt_distributor_veg_plants_amount = COALESCE(plants_nt_nomedical_distributor,0),
                            nu_distributor_veg_plants_amount = COALESCE(plants_nu_nomedical_distributor,0),
                            on_distributor_veg_plants_amount = COALESCE(plants_on_nomedical_distributor,0),
                            pe_distributor_veg_plants_amount = COALESCE(plants_pe_nomedical_distributor,0),
                            qc_distributor_veg_plants_amount = COALESCE(plants_qc_nomedical_distributor,0), 
                            sk_distributor_veg_plants_amount = COALESCE(plants_sk_nomedical_distributor,0), 
                            yt_distributor_veg_plants_amount = COALESCE(plants_yt_nomedical_distributor,0), 
                            total_distributor_veg_plants_amount = COALESCE(plants_total_nomedical_distributor,0),
                            
                            ab_distributor_veg_plants_value = COALESCE(plants_ab_nomedical_distributor_value,0),
                            bc_distributor_veg_plants_value = COALESCE(plants_bc_nomedical_distributor_value,0),
                            mb_distributor_veg_plants_value = COALESCE(plants_mb_nomedical_distributor_value,0),
                            nb_distributor_veg_plants_value = COALESCE(plants_nb_nomedical_distributor_value,0), 
                            nl_distributor_veg_plants_value = COALESCE(plants_nl_nomedical_distributor_value,0), 
                            ns_distributor_veg_plants_value = COALESCE(plants_ns_nomedical_distributor_value,0),
                            nt_distributor_veg_plants_value = COALESCE(plants_nt_nomedical_distributor_value,0),
                            nu_distributor_veg_plants_value = COALESCE(plants_nu_nomedical_distributor_value,0),
                            on_distributor_veg_plants_value = COALESCE(plants_on_nomedical_distributor_value,0),
                            pe_distributor_veg_plants_value = COALESCE(plants_pe_nomedical_distributor_value,0),
                            qc_distributor_veg_plants_value = COALESCE(plants_qc_nomedical_distributor_value,0), 
                            sk_distributor_veg_plants_value = COALESCE(plants_sk_nomedical_distributor_value,0), 
                            yt_distributor_veg_plants_value = COALESCE(plants_yt_nomedical_distributor_value,0), 
                            total_distributor_veg_plants_value = COALESCE(plants_total_nomedical_distributor_value,0),

                            -- recreational consumer plants
                            ab_recreational_consumer_veg_plants_amount = COALESCE(plants_ab_nomedical_recreational_consumer,0),
                            bc_recreational_consumer_veg_plants_amount = COALESCE(plants_bc_nomedical_recreational_consumer,0),
                            mb_recreational_consumer_veg_plants_amount = COALESCE(plants_mb_nomedical_recreational_consumer,0),
                            nb_recreational_consumer_veg_plants_amount = COALESCE(plants_nb_nomedical_recreational_consumer,0), 
                            nl_recreational_consumer_veg_plants_amount = COALESCE(plants_nl_nomedical_recreational_consumer,0), 
                            ns_recreational_consumer_veg_plants_amount = COALESCE(plants_ns_nomedical_recreational_consumer,0),
                            nt_recreational_consumer_veg_plants_amount = COALESCE(plants_nt_nomedical_recreational_consumer,0),
                            nu_recreational_consumer_veg_plants_amount = COALESCE(plants_nu_nomedical_recreational_consumer,0),
                            on_recreational_consumer_veg_plants_amount = COALESCE(plants_on_nomedical_recreational_consumer,0),
                            pe_recreational_consumer_veg_plants_amount = COALESCE(plants_pe_nomedical_recreational_consumer,0),
                            qc_recreational_consumer_veg_plants_amount = COALESCE(plants_qc_nomedical_recreational_consumer,0), 
                            sk_recreational_consumer_veg_plants_amount = COALESCE(plants_sk_nomedical_recreational_consumer,0), 
                            yt_recreational_consumer_veg_plants_amount = COALESCE(plants_yt_nomedical_recreational_consumer,0), 
                            total_recreational_consumer_veg_plants_amount = COALESCE(plants_total_nomedical_recreational_consumer,0),
                            
                            ab_recreational_consumer_veg_plants_value = COALESCE(plants_ab_nomedical_recreational_consumer_value,0),
                            bc_recreational_consumer_veg_plants_value = COALESCE(plants_bc_nomedical_recreational_consumer_value,0),
                            mb_recreational_consumer_veg_plants_value = COALESCE(plants_mb_nomedical_recreational_consumer_value,0),
                            nb_recreational_consumer_veg_plants_value = COALESCE(plants_nb_nomedical_recreational_consumer_value,0), 
                            nl_recreational_consumer_veg_plants_value = COALESCE(plants_nl_nomedical_recreational_consumer_value,0), 
                            ns_recreational_consumer_veg_plants_value = COALESCE(plants_ns_nomedical_recreational_consumer_value,0),
                            nt_recreational_consumer_veg_plants_value = COALESCE(plants_nt_nomedical_recreational_consumer_value,0),
                            nu_recreational_consumer_veg_plants_value = COALESCE(plants_nu_nomedical_recreational_consumer_value,0),
                            on_recreational_consumer_veg_plants_value = COALESCE(plants_on_nomedical_recreational_consumer_value,0),
                            pe_recreational_consumer_veg_plants_value = COALESCE(plants_pe_nomedical_recreational_consumer_value,0),
                            qc_recreational_consumer_veg_plants_value = COALESCE(plants_qc_nomedical_recreational_consumer_value,0), 
                            sk_recreational_consumer_veg_plants_value = COALESCE(plants_sk_nomedical_recreational_consumer_value,0), 
                            yt_recreational_consumer_veg_plants_value = COALESCE(plants_yt_nomedical_recreational_consumer_value,0), 
                            total_recreational_consumer_veg_plants_value = COALESCE(plants_total_nomedical_recreational_consumer_value,0),

                            -- retailer plants
                            ab_retailer_veg_plants_amount = COALESCE(plants_ab_nomedical_retailer,0),
                            bc_retailer_veg_plants_amount = COALESCE(plants_bc_nomedical_retailer,0),
                            mb_retailer_veg_plants_amount = COALESCE(plants_mb_nomedical_retailer,0),
                            nb_retailer_veg_plants_amount = COALESCE(plants_nb_nomedical_retailer,0), 
                            nl_retailer_veg_plants_amount = COALESCE(plants_nl_nomedical_retailer,0), 
                            ns_retailer_veg_plants_amount = COALESCE(plants_ns_nomedical_retailer,0),
                            nt_retailer_veg_plants_amount = COALESCE(plants_nt_nomedical_retailer,0),
                            nu_retailer_veg_plants_amount = COALESCE(plants_nu_nomedical_retailer,0),
                            on_retailer_veg_plants_amount = COALESCE(plants_on_nomedical_retailer,0),
                            pe_retailer_veg_plants_amount = COALESCE(plants_pe_nomedical_retailer,0),
                            qc_retailer_veg_plants_amount = COALESCE(plants_qc_nomedical_retailer,0), 
                            sk_retailer_veg_plants_amount = COALESCE(plants_sk_nomedical_retailer,0), 
                            yt_retailer_veg_plants_amount = COALESCE(plants_yt_nomedical_retailer,0), 
                            total_retailer_veg_plants_amount = COALESCE(plants_total_nomedical_retailer,0),
                            
                            ab_retailer_veg_plants_value = COALESCE(plants_ab_nomedical_retailer_value,0),
                            bc_retailer_veg_plants_value = COALESCE(plants_bc_nomedical_retailer_value,0),
                            mb_retailer_veg_plants_value = COALESCE(plants_mb_nomedical_retailer_value,0),
                            nb_retailer_veg_plants_value = COALESCE(plants_nb_nomedical_retailer_value,0), 
                            nl_retailer_veg_plants_value = COALESCE(plants_nl_nomedical_retailer_value,0), 
                            ns_retailer_veg_plants_value = COALESCE(plants_ns_nomedical_retailer_value,0),
                            nt_retailer_veg_plants_value = COALESCE(plants_nt_nomedical_retailer_value,0),
                            nu_retailer_veg_plants_value = COALESCE(plants_nu_nomedical_retailer_value,0),
                            on_retailer_veg_plants_value = COALESCE(plants_on_nomedical_retailer_value,0),
                            pe_retailer_veg_plants_value = COALESCE(plants_pe_nomedical_retailer_value,0),
                            qc_retailer_veg_plants_value = COALESCE(plants_qc_nomedical_retailer_value,0), 
                            sk_retailer_veg_plants_value = COALESCE(plants_sk_nomedical_retailer_value,0), 
                            yt_retailer_veg_plants_value = COALESCE(plants_yt_nomedical_retailer_value,0), 
                            total_retailer_veg_plants_value = COALESCE(plants_total_nomedical_retailer_value,0),

                            -- intra industry plants
                            ab_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_ab_nomedical_intra_industry_unpackaged,0),
                            bc_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_bc_nomedical_intra_industry_unpackaged,0),
                            mb_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_mb_nomedical_intra_industry_unpackaged,0),
                            nb_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_nb_nomedical_intra_industry_unpackaged,0), 
                            nl_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_nl_nomedical_intra_industry_unpackaged,0), 
                            ns_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_ns_nomedical_intra_industry_unpackaged,0),
                            nt_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_nt_nomedical_intra_industry_unpackaged,0),
                            nu_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_nu_nomedical_intra_industry_unpackaged,0),
                            on_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_on_nomedical_intra_industry_unpackaged,0),
                            pe_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_pe_nomedical_intra_industry_unpackaged,0),
                            qc_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_qc_nomedical_intra_industry_unpackaged,0), 
                            sk_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_sk_nomedical_intra_industry_unpackaged,0),
                            yt_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_yt_nomedical_intra_industry_unpackaged,0), 
                            total_unpackaged_intra_industry_veg_plants_amount = COALESCE(plants_total_nomedical_intra_industry_unpackaged,0),
                            
                            ab_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_ab_nomedical_intra_industry_unpackaged_value,0),
                            mb_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_mb_nomedical_intra_industry_unpackaged_value,0),
                            bc_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_bc_nomedical_intra_industry_unpackaged_value,0),
                            nb_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_nb_nomedical_intra_industry_unpackaged_value,0), 
                            nl_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_nl_nomedical_intra_industry_unpackaged_value,0), 
                            ns_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_ns_nomedical_intra_industry_unpackaged_value,0),
                            nt_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_nt_nomedical_intra_industry_unpackaged_value,0),
                            nu_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_nu_nomedical_intra_industry_unpackaged_value,0),
                            on_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_on_nomedical_intra_industry_unpackaged_value,0),
                            pe_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_pe_nomedical_intra_industry_unpackaged_value,0),
                            qc_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_qc_nomedical_intra_industry_unpackaged_value,0), 
                            sk_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_sk_nomedical_intra_industry_unpackaged_value,0),
                            yt_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_yt_nomedical_intra_industry_unpackaged_value,0), 
                            total_unpackaged_intra_industry_veg_plants_value = COALESCE(plants_total_nomedical_intra_industry_unpackaged_value,0),

                            ab_packaged_intra_industry_veg_plants_amount = COALESCE(plants_ab_nomedical_intra_industry_packaged,0),
                            bc_packaged_intra_industry_veg_plants_amount = COALESCE(plants_bc_nomedical_intra_industry_packaged,0),
                            mb_packaged_intra_industry_veg_plants_amount = COALESCE(plants_mb_nomedical_intra_industry_packaged,0),
                            nb_packaged_intra_industry_veg_plants_amount = COALESCE(plants_nb_nomedical_intra_industry_packaged,0), 
                            nl_packaged_intra_industry_veg_plants_amount = COALESCE(plants_nl_nomedical_intra_industry_packaged,0), 
                            ns_packaged_intra_industry_veg_plants_amount = COALESCE(plants_ns_nomedical_intra_industry_packaged,0),
                            nt_packaged_intra_industry_veg_plants_amount = COALESCE(plants_nt_nomedical_intra_industry_packaged,0),
                            nu_packaged_intra_industry_veg_plants_amount = COALESCE(plants_nu_nomedical_intra_industry_packaged,0),
                            on_packaged_intra_industry_veg_plants_amount = COALESCE(plants_on_nomedical_intra_industry_packaged,0),
                            pe_packaged_intra_industry_veg_plants_amount = COALESCE(plants_pe_nomedical_intra_industry_packaged,0),
                            qc_packaged_intra_industry_veg_plants_amount = COALESCE(plants_qc_nomedical_intra_industry_packaged,0), 
                            sk_packaged_intra_industry_veg_plants_amount = COALESCE(plants_sk_nomedical_intra_industry_packaged,0),
                            yt_packaged_intra_industry_veg_plants_amount = COALESCE(plants_yt_nomedical_intra_industry_packaged,0), 
                            total_packaged_intra_industry_veg_plants_amount = COALESCE(plants_total_nomedical_intra_industry_packaged,0),

                            ab_packaged_intra_industry_veg_plants_value = COALESCE(plants_ab_nomedical_intra_industry_packaged_value,0),
                            mb_packaged_intra_industry_veg_plants_value = COALESCE(plants_mb_nomedical_intra_industry_packaged_value,0),
                            bc_packaged_intra_industry_veg_plants_value = COALESCE(plants_bc_nomedical_intra_industry_packaged_value,0),
                            nb_packaged_intra_industry_veg_plants_value = COALESCE(plants_nb_nomedical_intra_industry_packaged_value,0), 
                            nl_packaged_intra_industry_veg_plants_value = COALESCE(plants_nl_nomedical_intra_industry_packaged_value,0), 
                            ns_packaged_intra_industry_veg_plants_value = COALESCE(plants_ns_nomedical_intra_industry_packaged_value,0),
                            nt_packaged_intra_industry_veg_plants_value = COALESCE(plants_nt_nomedical_intra_industry_packaged_value,0),
                            nu_packaged_intra_industry_veg_plants_value = COALESCE(plants_nu_nomedical_intra_industry_packaged_value,0),
                            on_packaged_intra_industry_veg_plants_value = COALESCE(plants_on_nomedical_intra_industry_packaged_value,0),
                            pe_packaged_intra_industry_veg_plants_value = COALESCE(plants_pe_nomedical_intra_industry_packaged_value,0),
                            qc_packaged_intra_industry_veg_plants_value = COALESCE(plants_qc_nomedical_intra_industry_packaged_value,0), 
                            sk_packaged_intra_industry_veg_plants_value = COALESCE(plants_sk_nomedical_intra_industry_packaged_value,0),
                            yt_packaged_intra_industry_veg_plants_value = COALESCE(plants_yt_nomedical_intra_industry_packaged_value,0), 
                            total_packaged_intra_industry_veg_plants_value = COALESCE(plants_total_nomedical_intra_industry_packaged_value,0),

                            -- distributor fresh_cannabis
                            ab_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_ab_nomedical_distributor,0),
                            bc_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_bc_nomedical_distributor,0),
                            mb_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_mb_nomedical_distributor,0),
                            nb_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_nb_nomedical_distributor,0), 
                            nl_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_nl_nomedical_distributor,0), 
                            ns_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_ns_nomedical_distributor,0),
                            nt_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_nt_nomedical_distributor,0),
                            nu_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_nu_nomedical_distributor,0),
                            on_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_on_nomedical_distributor,0),
                            pe_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_pe_nomedical_distributor,0),
                            qc_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_qc_nomedical_distributor,0), 
                            sk_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_sk_nomedical_distributor,0), 
                            yt_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_yt_nomedical_distributor,0), 
                            total_distributor_fresh_cannabis_amount = COALESCE(fresh_cannabis_total_nomedical_distributor,0),
                            
                            ab_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_ab_nomedical_distributor_value,0),
                            bc_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_bc_nomedical_distributor_value,0),
                            mb_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_mb_nomedical_distributor_value,0),
                            nb_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_nb_nomedical_distributor_value,0), 
                            nl_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_nl_nomedical_distributor_value,0), 
                            ns_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_ns_nomedical_distributor_value,0),
                            nt_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_nt_nomedical_distributor_value,0),
                            nu_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_nu_nomedical_distributor_value,0),
                            on_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_on_nomedical_distributor_value,0),
                            pe_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_pe_nomedical_distributor_value,0),
                            qc_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_qc_nomedical_distributor_value,0), 
                            sk_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_sk_nomedical_distributor_value,0), 
                            yt_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_yt_nomedical_distributor_value,0), 
                            total_distributor_fresh_cannabis_value = COALESCE(fresh_cannabis_total_nomedical_distributor_value,0),

                            -- recreational consumer fresh_cannabis
                            ab_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_ab_nomedical_recreational_consumer,0),
                            bc_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_bc_nomedical_recreational_consumer,0),
                            mb_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_mb_nomedical_recreational_consumer,0),
                            nb_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_nb_nomedical_recreational_consumer,0), 
                            nl_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_nl_nomedical_recreational_consumer,0), 
                            ns_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_ns_nomedical_recreational_consumer,0),
                            nt_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_nt_nomedical_recreational_consumer,0),
                            nu_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_nu_nomedical_recreational_consumer,0),
                            on_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_on_nomedical_recreational_consumer,0),
                            pe_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_pe_nomedical_recreational_consumer,0),
                            qc_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_qc_nomedical_recreational_consumer,0), 
                            sk_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_sk_nomedical_recreational_consumer,0), 
                            yt_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_yt_nomedical_recreational_consumer,0), 
                            total_recreational_consumer_fresh_cannabis_amount = COALESCE(fresh_cannabis_total_nomedical_recreational_consumer,0),
                            
                            ab_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_ab_nomedical_recreational_consumer_value,0),
                            bc_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_bc_nomedical_recreational_consumer_value,0),
                            mb_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_mb_nomedical_recreational_consumer_value,0),
                            nb_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_nb_nomedical_recreational_consumer_value,0), 
                            nl_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_nl_nomedical_recreational_consumer_value,0), 
                            ns_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_ns_nomedical_recreational_consumer_value,0),
                            nt_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_nt_nomedical_recreational_consumer_value,0),
                            nu_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_nu_nomedical_recreational_consumer_value,0),
                            on_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_on_nomedical_recreational_consumer_value,0),
                            pe_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_pe_nomedical_recreational_consumer_value,0),
                            qc_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_qc_nomedical_recreational_consumer_value,0), 
                            sk_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_sk_nomedical_recreational_consumer_value,0), 
                            yt_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_yt_nomedical_recreational_consumer_value,0), 
                            total_recreational_consumer_fresh_cannabis_value = COALESCE(fresh_cannabis_total_nomedical_recreational_consumer_value,0),

                            -- retailer fresh_cannabis
                            ab_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_ab_nomedical_retailer,0),
                            bc_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_bc_nomedical_retailer,0),
                            mb_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_mb_nomedical_retailer,0),
                            nb_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_nb_nomedical_retailer,0), 
                            nl_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_nl_nomedical_retailer,0), 
                            ns_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_ns_nomedical_retailer,0),
                            nt_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_nt_nomedical_retailer,0),
                            nu_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_nu_nomedical_retailer,0),
                            on_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_on_nomedical_retailer,0),
                            pe_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_pe_nomedical_retailer,0),
                            qc_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_qc_nomedical_retailer,0), 
                            sk_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_sk_nomedical_retailer,0), 
                            yt_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_yt_nomedical_retailer,0), 
                            total_retailer_fresh_cannabis_amount = COALESCE(fresh_cannabis_total_nomedical_retailer,0),
                            
                            ab_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_ab_nomedical_retailer_value,0),
                            bc_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_bc_nomedical_retailer_value,0),
                            mb_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_mb_nomedical_retailer_value,0),
                            nb_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_nb_nomedical_retailer_value,0), 
                            nl_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_nl_nomedical_retailer_value,0), 
                            ns_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_ns_nomedical_retailer_value,0),
                            nt_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_nt_nomedical_retailer_value,0),
                            nu_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_nu_nomedical_retailer_value,0),
                            on_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_on_nomedical_retailer_value,0),
                            pe_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_pe_nomedical_retailer_value,0),
                            qc_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_qc_nomedical_retailer_value,0), 
                            sk_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_sk_nomedical_retailer_value,0), 
                            yt_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_yt_nomedical_retailer_value,0), 
                            total_retailer_fresh_cannabis_value = COALESCE(fresh_cannabis_total_nomedical_retailer_value,0),

                            -- intra industry fresh_cannabis
                            ab_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_ab_nomedical_intra_industry_unpackaged,0),
                            bc_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_bc_nomedical_intra_industry_unpackaged,0),
                            mb_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_mb_nomedical_intra_industry_unpackaged,0),
                            nb_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_nb_nomedical_intra_industry_unpackaged,0), 
                            nl_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_nl_nomedical_intra_industry_unpackaged,0), 
                            ns_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_ns_nomedical_intra_industry_unpackaged,0),
                            nt_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_nt_nomedical_intra_industry_unpackaged,0),
                            nu_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_nu_nomedical_intra_industry_unpackaged,0),
                            on_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_on_nomedical_intra_industry_unpackaged,0),
                            pe_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_pe_nomedical_intra_industry_unpackaged,0),
                            qc_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_qc_nomedical_intra_industry_unpackaged,0), 
                            sk_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_sk_nomedical_intra_industry_unpackaged,0),
                            yt_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_yt_nomedical_intra_industry_unpackaged,0), 
                            total_unpackaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_total_nomedical_intra_industry_unpackaged,0),
                            
                            ab_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_ab_nomedical_intra_industry_unpackaged_value,0),
                            bc_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_bc_nomedical_intra_industry_unpackaged_value,0),
                            mb_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_mb_nomedical_intra_industry_unpackaged_value,0),
                            nb_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_nb_nomedical_intra_industry_unpackaged_value,0), 
                            nl_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_nl_nomedical_intra_industry_unpackaged_value,0), 
                            ns_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_ns_nomedical_intra_industry_unpackaged_value,0),
                            nt_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_nt_nomedical_intra_industry_unpackaged_value,0),
                            nu_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_nu_nomedical_intra_industry_unpackaged_value,0),
                            on_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_on_nomedical_intra_industry_unpackaged_value,0),
                            pe_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_pe_nomedical_intra_industry_unpackaged_value,0),
                            qc_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_qc_nomedical_intra_industry_unpackaged_value,0), 
                            sk_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_sk_nomedical_intra_industry_unpackaged_value,0),
                            yt_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_yt_nomedical_intra_industry_unpackaged_value,0), 
                            total_unpackaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_total_nomedical_intra_industry_unpackaged_value,0),

                            ab_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_ab_nomedical_intra_industry_packaged,0),
                            bc_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_bc_nomedical_intra_industry_packaged,0),
                            mb_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_mb_nomedical_intra_industry_packaged,0),
                            nb_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_nb_nomedical_intra_industry_packaged,0), 
                            nl_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_nl_nomedical_intra_industry_packaged,0), 
                            ns_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_ns_nomedical_intra_industry_packaged,0),
                            nt_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_nt_nomedical_intra_industry_packaged,0),
                            nu_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_nu_nomedical_intra_industry_packaged,0),
                            on_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_on_nomedical_intra_industry_packaged,0),
                            pe_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_pe_nomedical_intra_industry_packaged,0),
                            qc_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_qc_nomedical_intra_industry_packaged,0), 
                            sk_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_sk_nomedical_intra_industry_packaged,0),
                            yt_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_yt_nomedical_intra_industry_packaged,0), 
                            total_packaged_intra_industry_fresh_cannabis_weight = COALESCE(fresh_cannabis_total_nomedical_intra_industry_packaged,0),
                            
                            ab_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_ab_nomedical_intra_industry_packaged_value,0),
                            bc_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_bc_nomedical_intra_industry_packaged_value,0),
                            mb_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_mb_nomedical_intra_industry_packaged_value,0),
                            nb_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_nb_nomedical_intra_industry_packaged_value,0), 
                            nl_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_nl_nomedical_intra_industry_packaged_value,0), 
                            ns_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_ns_nomedical_intra_industry_packaged_value,0),
                            nt_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_nt_nomedical_intra_industry_packaged_value,0),
                            nu_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_nu_nomedical_intra_industry_packaged_value,0),
                            on_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_on_nomedical_intra_industry_packaged_value,0),
                            pe_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_pe_nomedical_intra_industry_packaged_value,0),
                            qc_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_qc_nomedical_intra_industry_packaged_value,0), 
                            sk_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_sk_nomedical_intra_industry_packaged_value,0),
                            yt_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_yt_nomedical_intra_industry_packaged_value,0), 
                            total_packaged_intra_industry_fresh_cannabis_value = COALESCE(fresh_cannabis_total_nomedical_intra_industry_packaged_value,0),

                            -- distributor dried_cannabis
                            ab_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_ab_nomedical_distributor,0),
                            bc_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_bc_nomedical_distributor,0),
                            mb_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_mb_nomedical_distributor,0),
                            nb_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_nb_nomedical_distributor,0), 
                            nl_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_nl_nomedical_distributor,0), 
                            ns_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_ns_nomedical_distributor,0),
                            nt_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_nt_nomedical_distributor,0),
                            nu_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_nu_nomedical_distributor,0),
                            on_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_on_nomedical_distributor,0),
                            pe_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_pe_nomedical_distributor,0),
                            qc_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_qc_nomedical_distributor,0), 
                            sk_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_sk_nomedical_distributor,0), 
                            yt_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_yt_nomedical_distributor,0), 
                            total_distributor_dried_cannabis_amount = COALESCE(dried_cannabis_total_nomedical_distributor,0),
                            
                            ab_distributor_dried_cannabis_value = COALESCE(dried_cannabis_ab_nomedical_distributor_value,0),
                            bc_distributor_dried_cannabis_value = COALESCE(dried_cannabis_bc_nomedical_distributor_value,0),
                            mb_distributor_dried_cannabis_value = COALESCE(dried_cannabis_mb_nomedical_distributor_value,0),
                            nb_distributor_dried_cannabis_value = COALESCE(dried_cannabis_nb_nomedical_distributor_value,0), 
                            nl_distributor_dried_cannabis_value = COALESCE(dried_cannabis_nl_nomedical_distributor_value,0), 
                            ns_distributor_dried_cannabis_value = COALESCE(dried_cannabis_ns_nomedical_distributor_value,0),
                            nt_distributor_dried_cannabis_value = COALESCE(dried_cannabis_nt_nomedical_distributor_value,0),
                            nu_distributor_dried_cannabis_value = COALESCE(dried_cannabis_nu_nomedical_distributor_value,0),
                            on_distributor_dried_cannabis_value = COALESCE(dried_cannabis_on_nomedical_distributor_value,0),
                            pe_distributor_dried_cannabis_value = COALESCE(dried_cannabis_pe_nomedical_distributor_value,0),
                            qc_distributor_dried_cannabis_value = COALESCE(dried_cannabis_qc_nomedical_distributor_value,0), 
                            sk_distributor_dried_cannabis_value = COALESCE(dried_cannabis_sk_nomedical_distributor_value,0), 
                            yt_distributor_dried_cannabis_value = COALESCE(dried_cannabis_yt_nomedical_distributor_value,0), 
                            total_distributor_dried_cannabis_value = COALESCE(dried_cannabis_total_nomedical_distributor_value,0),

                            -- recreational consumer dried_cannabis
                            ab_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_ab_nomedical_recreational_consumer,0),
                            bc_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_bc_nomedical_recreational_consumer,0),
                            mb_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_mb_nomedical_recreational_consumer,0),
                            nb_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_nb_nomedical_recreational_consumer,0), 
                            nl_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_nl_nomedical_recreational_consumer,0), 
                            ns_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_ns_nomedical_recreational_consumer,0),
                            nt_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_nt_nomedical_recreational_consumer,0),
                            nu_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_nu_nomedical_recreational_consumer,0),
                            on_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_on_nomedical_recreational_consumer,0),
                            pe_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_pe_nomedical_recreational_consumer,0),
                            qc_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_qc_nomedical_recreational_consumer,0), 
                            sk_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_sk_nomedical_recreational_consumer,0), 
                            yt_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_yt_nomedical_recreational_consumer,0), 
                            total_recreational_consumer_dried_cannabis_amount = COALESCE(dried_cannabis_total_nomedical_recreational_consumer,0),
                            
                            ab_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_ab_nomedical_recreational_consumer_value,0),
                            bc_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_bc_nomedical_recreational_consumer_value,0),
                            mb_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_mb_nomedical_recreational_consumer_value,0),
                            nb_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_nb_nomedical_recreational_consumer_value,0), 
                            nl_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_nl_nomedical_recreational_consumer_value,0), 
                            ns_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_ns_nomedical_recreational_consumer_value,0),
                            nt_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_nt_nomedical_recreational_consumer_value,0),
                            nu_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_nu_nomedical_recreational_consumer_value,0),
                            on_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_on_nomedical_recreational_consumer_value,0),
                            pe_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_pe_nomedical_recreational_consumer_value,0),
                            qc_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_qc_nomedical_recreational_consumer_value,0), 
                            sk_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_sk_nomedical_recreational_consumer_value,0), 
                            yt_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_yt_nomedical_recreational_consumer_value,0), 
                            total_recreational_consumer_dried_cannabis_value = COALESCE(dried_cannabis_total_nomedical_recreational_consumer_value,0),

                            -- retailer dried_cannabis
                            ab_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_ab_nomedical_retailer,0),
                            bc_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_bc_nomedical_retailer,0),
                            mb_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_mb_nomedical_retailer,0),
                            nb_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_nb_nomedical_retailer,0), 
                            nl_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_nl_nomedical_retailer,0), 
                            ns_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_ns_nomedical_retailer,0),
                            nt_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_nt_nomedical_retailer,0),
                            nu_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_nu_nomedical_retailer,0),
                            on_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_on_nomedical_retailer,0),
                            pe_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_pe_nomedical_retailer,0),
                            qc_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_qc_nomedical_retailer,0), 
                            sk_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_sk_nomedical_retailer,0), 
                            yt_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_yt_nomedical_retailer,0), 
                            total_retailer_dried_cannabis_amount = COALESCE(dried_cannabis_total_nomedical_retailer,0),
                            
                            ab_retailer_dried_cannabis_value = COALESCE(dried_cannabis_ab_nomedical_retailer_value,0),
                            bc_retailer_dried_cannabis_value = COALESCE(dried_cannabis_bc_nomedical_retailer_value,0),
                            mb_retailer_dried_cannabis_value = COALESCE(dried_cannabis_mb_nomedical_retailer_value,0),
                            nb_retailer_dried_cannabis_value = COALESCE(dried_cannabis_nb_nomedical_retailer_value,0), 
                            nl_retailer_dried_cannabis_value = COALESCE(dried_cannabis_nl_nomedical_retailer_value,0), 
                            ns_retailer_dried_cannabis_value = COALESCE(dried_cannabis_ns_nomedical_retailer_value,0),
                            nt_retailer_dried_cannabis_value = COALESCE(dried_cannabis_nt_nomedical_retailer_value,0),
                            nu_retailer_dried_cannabis_value = COALESCE(dried_cannabis_nu_nomedical_retailer_value,0),
                            on_retailer_dried_cannabis_value = COALESCE(dried_cannabis_on_nomedical_retailer_value,0),
                            pe_retailer_dried_cannabis_value = COALESCE(dried_cannabis_pe_nomedical_retailer_value,0),
                            qc_retailer_dried_cannabis_value = COALESCE(dried_cannabis_qc_nomedical_retailer_value,0), 
                            sk_retailer_dried_cannabis_value = COALESCE(dried_cannabis_sk_nomedical_retailer_value,0), 
                            yt_retailer_dried_cannabis_value = COALESCE(dried_cannabis_yt_nomedical_retailer_value,0), 
                            total_retailer_dried_cannabis_value = COALESCE(dried_cannabis_total_nomedical_retailer_value,0),

                            -- intra industry dried_cannabis
                            ab_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_ab_nomedical_intra_industry_unpackaged,0),
                            bc_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_bc_nomedical_intra_industry_unpackaged,0),
                            mb_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_mb_nomedical_intra_industry_unpackaged,0),
                            nb_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_nb_nomedical_intra_industry_unpackaged,0), 
                            nl_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_nl_nomedical_intra_industry_unpackaged,0), 
                            ns_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_ns_nomedical_intra_industry_unpackaged,0),
                            nt_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_nt_nomedical_intra_industry_unpackaged,0),
                            nu_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_nu_nomedical_intra_industry_unpackaged,0),
                            on_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_on_nomedical_intra_industry_unpackaged,0),
                            pe_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_pe_nomedical_intra_industry_unpackaged,0),
                            qc_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_qc_nomedical_intra_industry_unpackaged,0), 
                            sk_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_sk_nomedical_intra_industry_unpackaged,0),
                            yt_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_yt_nomedical_intra_industry_unpackaged,0), 
                            total_unpackaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_total_nomedical_intra_industry_unpackaged,0),
                            
                            ab_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_ab_nomedical_intra_industry_unpackaged_value,0),
                            bc_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_bc_nomedical_intra_industry_unpackaged_value,0),
                            mb_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_mb_nomedical_intra_industry_unpackaged_value,0),
                            nb_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_nb_nomedical_intra_industry_unpackaged_value,0), 
                            nl_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_nl_nomedical_intra_industry_unpackaged_value,0), 
                            ns_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_ns_nomedical_intra_industry_unpackaged_value,0),
                            nt_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_nt_nomedical_intra_industry_unpackaged_value,0),
                            nu_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_nu_nomedical_intra_industry_unpackaged_value,0),
                            on_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_on_nomedical_intra_industry_unpackaged_value,0),
                            pe_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_pe_nomedical_intra_industry_unpackaged_value,0),
                            qc_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_qc_nomedical_intra_industry_unpackaged_value,0), 
                            sk_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_sk_nomedical_intra_industry_unpackaged_value,0),
                            yt_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_yt_nomedical_intra_industry_unpackaged_value,0), 
                            total_unpackaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_total_nomedical_intra_industry_unpackaged_value,0),

                            ab_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_ab_nomedical_intra_industry_packaged,0),
                            bc_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_bc_nomedical_intra_industry_packaged,0),
                            mb_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_mb_nomedical_intra_industry_packaged,0),
                            nb_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_nb_nomedical_intra_industry_packaged,0), 
                            nl_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_nl_nomedical_intra_industry_packaged,0), 
                            ns_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_ns_nomedical_intra_industry_packaged,0),
                            nt_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_nt_nomedical_intra_industry_packaged,0),
                            nu_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_nu_nomedical_intra_industry_packaged,0),
                            on_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_on_nomedical_intra_industry_packaged,0),
                            pe_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_pe_nomedical_intra_industry_packaged,0),
                            qc_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_qc_nomedical_intra_industry_packaged,0), 
                            sk_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_sk_nomedical_intra_industry_packaged,0),
                            yt_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_yt_nomedical_intra_industry_packaged,0), 
                            total_packaged_intra_industry_dried_cannabis_weight = COALESCE(dried_cannabis_total_nomedical_intra_industry_packaged,0),
                            
                            ab_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_ab_nomedical_intra_industry_packaged_value,0),
                            bc_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_bc_nomedical_intra_industry_packaged_value,0),
                            mb_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_mb_nomedical_intra_industry_packaged_value,0),
                            nb_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_nb_nomedical_intra_industry_packaged_value,0), 
                            nl_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_nl_nomedical_intra_industry_packaged_value,0), 
                            ns_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_ns_nomedical_intra_industry_packaged_value,0),
                            nt_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_nt_nomedical_intra_industry_packaged_value,0),
                            nu_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_nu_nomedical_intra_industry_packaged_value,0),
                            on_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_on_nomedical_intra_industry_packaged_value,0),
                            pe_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_pe_nomedical_intra_industry_packaged_value,0),
                            qc_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_qc_nomedical_intra_industry_packaged_value,0), 
                            sk_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_sk_nomedical_intra_industry_packaged_value,0),
                            yt_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_yt_nomedical_intra_industry_packaged_value,0), 
                            total_packaged_intra_industry_dried_cannabis_value = COALESCE(dried_cannabis_total_nomedical_intra_industry_packaged_value,0),

                            -- distributor extracts
                            ab_distributor_extracts_amount = COALESCE(extracts_ab_nomedical_distributor,0),
                            bc_distributor_extracts_amount = COALESCE(extracts_bc_nomedical_distributor,0),
                            mb_distributor_extracts_amount = COALESCE(extracts_mb_nomedical_distributor,0),
                            nb_distributor_extracts_amount = COALESCE(extracts_nb_nomedical_distributor,0), 
                            nl_distributor_extracts_amount = COALESCE(extracts_nl_nomedical_distributor,0), 
                            ns_distributor_extracts_amount = COALESCE(extracts_ns_nomedical_distributor,0),
                            nt_distributor_extracts_amount = COALESCE(extracts_nt_nomedical_distributor,0),
                            nu_distributor_extracts_amount = COALESCE(extracts_nu_nomedical_distributor,0),
                            on_distributor_extracts_amount = COALESCE(extracts_on_nomedical_distributor,0),
                            pe_distributor_extracts_amount = COALESCE(extracts_pe_nomedical_distributor,0),
                            qc_distributor_extracts_amount = COALESCE(extracts_qc_nomedical_distributor,0), 
                            sk_distributor_extracts_amount = COALESCE(extracts_sk_nomedical_distributor,0), 
                            yt_distributor_extracts_amount = COALESCE(extracts_yt_nomedical_distributor,0), 
                            total_distributor_extracts_amount = COALESCE(extracts_total_nomedical_distributor,0),
                            
                            ab_distributor_extracts_value = COALESCE(extracts_ab_nomedical_distributor_value,0),
                            bc_distributor_extracts_value = COALESCE(extracts_bc_nomedical_distributor_value,0),
                            mb_distributor_extracts_value = COALESCE(extracts_mb_nomedical_distributor_value,0),
                            nb_distributor_extracts_value = COALESCE(extracts_nb_nomedical_distributor_value,0), 
                            nl_distributor_extracts_value = COALESCE(extracts_nl_nomedical_distributor_value,0), 
                            ns_distributor_extracts_value = COALESCE(extracts_ns_nomedical_distributor_value,0),
                            nt_distributor_extracts_value = COALESCE(extracts_nt_nomedical_distributor_value,0),
                            nu_distributor_extracts_value = COALESCE(extracts_nu_nomedical_distributor_value,0),
                            on_distributor_extracts_value = COALESCE(extracts_on_nomedical_distributor_value,0),
                            pe_distributor_extracts_value = COALESCE(extracts_pe_nomedical_distributor_value,0),
                            qc_distributor_extracts_value = COALESCE(extracts_qc_nomedical_distributor_value,0), 
                            sk_distributor_extracts_value = COALESCE(extracts_sk_nomedical_distributor_value,0), 
                            yt_distributor_extracts_value = COALESCE(extracts_yt_nomedical_distributor_value,0), 
                            total_distributor_extracts_value = COALESCE(extracts_total_nomedical_distributor_value,0),

                            -- recreational consumer extracts
                            ab_recreational_consumer_extracts_amount = COALESCE(extracts_ab_nomedical_recreational_consumer,0),
                            bc_recreational_consumer_extracts_amount = COALESCE(extracts_bc_nomedical_recreational_consumer,0),
                            mb_recreational_consumer_extracts_amount = COALESCE(extracts_mb_nomedical_recreational_consumer,0),
                            nb_recreational_consumer_extracts_amount = COALESCE(extracts_nb_nomedical_recreational_consumer,0), 
                            nl_recreational_consumer_extracts_amount = COALESCE(extracts_nl_nomedical_recreational_consumer,0), 
                            ns_recreational_consumer_extracts_amount = COALESCE(extracts_ns_nomedical_recreational_consumer,0),
                            nt_recreational_consumer_extracts_amount = COALESCE(extracts_nt_nomedical_recreational_consumer,0),
                            nu_recreational_consumer_extracts_amount = COALESCE(extracts_nu_nomedical_recreational_consumer,0),
                            on_recreational_consumer_extracts_amount = COALESCE(extracts_on_nomedical_recreational_consumer,0),
                            pe_recreational_consumer_extracts_amount = COALESCE(extracts_pe_nomedical_recreational_consumer,0),
                            qc_recreational_consumer_extracts_amount = COALESCE(extracts_qc_nomedical_recreational_consumer,0), 
                            sk_recreational_consumer_extracts_amount = COALESCE(extracts_sk_nomedical_recreational_consumer,0), 
                            yt_recreational_consumer_extracts_amount = COALESCE(extracts_yt_nomedical_recreational_consumer,0), 
                            total_recreational_consumer_extracts_amount = COALESCE(extracts_total_nomedical_recreational_consumer,0),
                            
                            ab_recreational_consumer_extracts_value = COALESCE(extracts_ab_nomedical_recreational_consumer_value,0),
                            bc_recreational_consumer_extracts_value = COALESCE(extracts_bc_nomedical_recreational_consumer_value,0),
                            mb_recreational_consumer_extracts_value = COALESCE(extracts_mb_nomedical_recreational_consumer_value,0),
                            nb_recreational_consumer_extracts_value = COALESCE(extracts_nb_nomedical_recreational_consumer_value,0), 
                            nl_recreational_consumer_extracts_value = COALESCE(extracts_nl_nomedical_recreational_consumer_value,0), 
                            ns_recreational_consumer_extracts_value = COALESCE(extracts_ns_nomedical_recreational_consumer_value,0),
                            nt_recreational_consumer_extracts_value = COALESCE(extracts_nt_nomedical_recreational_consumer_value,0),
                            nu_recreational_consumer_extracts_value = COALESCE(extracts_nu_nomedical_recreational_consumer_value,0),
                            on_recreational_consumer_extracts_value = COALESCE(extracts_on_nomedical_recreational_consumer_value,0),
                            pe_recreational_consumer_extracts_value = COALESCE(extracts_pe_nomedical_recreational_consumer_value,0),
                            qc_recreational_consumer_extracts_value = COALESCE(extracts_qc_nomedical_recreational_consumer_value,0), 
                            sk_recreational_consumer_extracts_value = COALESCE(extracts_sk_nomedical_recreational_consumer_value,0), 
                            yt_recreational_consumer_extracts_value = COALESCE(extracts_yt_nomedical_recreational_consumer_value,0), 
                            total_recreational_consumer_extracts_value = COALESCE(extracts_total_nomedical_recreational_consumer_value,0),

                            -- retailer extracts
                            ab_retailer_extracts_amount = COALESCE(extracts_ab_nomedical_retailer,0),
                            bc_retailer_extracts_amount = COALESCE(extracts_bc_nomedical_retailer,0),
                            mb_retailer_extracts_amount = COALESCE(extracts_mb_nomedical_retailer,0),
                            nb_retailer_extracts_amount = COALESCE(extracts_nb_nomedical_retailer,0), 
                            nl_retailer_extracts_amount = COALESCE(extracts_nl_nomedical_retailer,0), 
                            ns_retailer_extracts_amount = COALESCE(extracts_ns_nomedical_retailer,0),
                            nt_retailer_extracts_amount = COALESCE(extracts_nt_nomedical_retailer,0),
                            nu_retailer_extracts_amount = COALESCE(extracts_nu_nomedical_retailer,0),
                            on_retailer_extracts_amount = COALESCE(extracts_on_nomedical_retailer,0),
                            pe_retailer_extracts_amount = COALESCE(extracts_pe_nomedical_retailer,0),
                            qc_retailer_extracts_amount = COALESCE(extracts_qc_nomedical_retailer,0), 
                            sk_retailer_extracts_amount = COALESCE(extracts_sk_nomedical_retailer,0), 
                            yt_retailer_extracts_amount = COALESCE(extracts_yt_nomedical_retailer,0), 
                            total_retailer_extracts_amount = COALESCE(extracts_total_nomedical_retailer,0),
                            
                            ab_retailer_extracts_value = COALESCE(extracts_ab_nomedical_retailer_value,0),
                            bc_retailer_extracts_value = COALESCE(extracts_bc_nomedical_retailer_value,0),
                            mb_retailer_extracts_value = COALESCE(extracts_mb_nomedical_retailer_value,0),
                            nb_retailer_extracts_value = COALESCE(extracts_nb_nomedical_retailer_value,0), 
                            nl_retailer_extracts_value = COALESCE(extracts_nl_nomedical_retailer_value,0), 
                            ns_retailer_extracts_value = COALESCE(extracts_ns_nomedical_retailer_value,0),
                            nt_retailer_extracts_value = COALESCE(extracts_nt_nomedical_retailer_value,0),
                            nu_retailer_extracts_value = COALESCE(extracts_nu_nomedical_retailer_value,0),
                            on_retailer_extracts_value = COALESCE(extracts_on_nomedical_retailer_value,0),
                            pe_retailer_extracts_value = COALESCE(extracts_pe_nomedical_retailer_value,0),
                            qc_retailer_extracts_value = COALESCE(extracts_qc_nomedical_retailer_value,0), 
                            sk_retailer_extracts_value = COALESCE(extracts_sk_nomedical_retailer_value,0), 
                            yt_retailer_extracts_value = COALESCE(extracts_yt_nomedical_retailer_value,0), 
                            total_retailer_extracts_value = COALESCE(extracts_total_nomedical_retailer_value,0),

                            -- intra industry extracts
                            ab_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_ab_nomedical_intra_industry_unpackaged,0),
                            bc_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_bc_nomedical_intra_industry_unpackaged,0),
                            mb_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_mb_nomedical_intra_industry_unpackaged,0),
                            nb_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_nb_nomedical_intra_industry_unpackaged,0), 
                            nl_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_nl_nomedical_intra_industry_unpackaged,0), 
                            ns_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_ns_nomedical_intra_industry_unpackaged,0),
                            nt_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_nt_nomedical_intra_industry_unpackaged,0),
                            nu_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_nu_nomedical_intra_industry_unpackaged,0),
                            on_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_on_nomedical_intra_industry_unpackaged,0),
                            pe_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_pe_nomedical_intra_industry_unpackaged,0),
                            qc_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_qc_nomedical_intra_industry_unpackaged,0), 
                            sk_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_sk_nomedical_intra_industry_unpackaged,0),
                            yt_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_yt_nomedical_intra_industry_unpackaged,0), 
                            total_unpackaged_intra_industry_extracts_weight = COALESCE(extracts_total_nomedical_intra_industry_unpackaged,0),
                            
                            ab_unpackaged_intra_industry_extracts_value = COALESCE(extracts_ab_nomedical_intra_industry_unpackaged_value,0),
                            bc_unpackaged_intra_industry_extracts_value = COALESCE(extracts_bc_nomedical_intra_industry_unpackaged_value,0),
                            mb_unpackaged_intra_industry_extracts_value = COALESCE(extracts_mb_nomedical_intra_industry_unpackaged_value,0),
                            nb_unpackaged_intra_industry_extracts_value = COALESCE(extracts_nb_nomedical_intra_industry_unpackaged_value,0), 
                            nl_unpackaged_intra_industry_extracts_value = COALESCE(extracts_nl_nomedical_intra_industry_unpackaged_value,0), 
                            ns_unpackaged_intra_industry_extracts_value = COALESCE(extracts_ns_nomedical_intra_industry_unpackaged_value,0),
                            nt_unpackaged_intra_industry_extracts_value = COALESCE(extracts_nt_nomedical_intra_industry_unpackaged_value,0),
                            nu_unpackaged_intra_industry_extracts_value = COALESCE(extracts_nu_nomedical_intra_industry_unpackaged_value,0),
                            on_unpackaged_intra_industry_extracts_value = COALESCE(extracts_on_nomedical_intra_industry_unpackaged_value,0),
                            pe_unpackaged_intra_industry_extracts_value = COALESCE(extracts_pe_nomedical_intra_industry_unpackaged_value,0),
                            qc_unpackaged_intra_industry_extracts_value = COALESCE(extracts_qc_nomedical_intra_industry_unpackaged_value,0), 
                            sk_unpackaged_intra_industry_extracts_value = COALESCE(extracts_sk_nomedical_intra_industry_unpackaged_value,0),
                            yt_unpackaged_intra_industry_extracts_value = COALESCE(extracts_yt_nomedical_intra_industry_unpackaged_value,0), 
                            total_unpackaged_intra_industry_extracts_value = COALESCE(extracts_total_nomedical_intra_industry_unpackaged_value,0),

                            ab_packaged_intra_industry_extracts_weight = COALESCE(extracts_ab_nomedical_intra_industry_packaged,0),
                            bc_packaged_intra_industry_extracts_weight = COALESCE(extracts_bc_nomedical_intra_industry_packaged,0),
                            mb_packaged_intra_industry_extracts_weight = COALESCE(extracts_mb_nomedical_intra_industry_packaged,0),
                            nb_packaged_intra_industry_extracts_weight = COALESCE(extracts_nb_nomedical_intra_industry_packaged,0), 
                            nl_packaged_intra_industry_extracts_weight = COALESCE(extracts_nl_nomedical_intra_industry_packaged,0), 
                            ns_packaged_intra_industry_extracts_weight = COALESCE(extracts_ns_nomedical_intra_industry_packaged,0),
                            nt_packaged_intra_industry_extracts_weight = COALESCE(extracts_nt_nomedical_intra_industry_packaged,0),
                            nu_packaged_intra_industry_extracts_weight = COALESCE(extracts_nu_nomedical_intra_industry_packaged,0),
                            on_packaged_intra_industry_extracts_weight = COALESCE(extracts_on_nomedical_intra_industry_packaged,0),
                            pe_packaged_intra_industry_extracts_weight = COALESCE(extracts_pe_nomedical_intra_industry_packaged,0),
                            qc_packaged_intra_industry_extracts_weight = COALESCE(extracts_qc_nomedical_intra_industry_packaged,0), 
                            sk_packaged_intra_industry_extracts_weight = COALESCE(extracts_sk_nomedical_intra_industry_packaged,0),
                            yt_packaged_intra_industry_extracts_weight = COALESCE(extracts_yt_nomedical_intra_industry_packaged,0), 
                            total_packaged_intra_industry_extracts_weight = COALESCE(extracts_total_nomedical_intra_industry_packaged,0),
                            
                            ab_packaged_intra_industry_extracts_value = COALESCE(extracts_ab_nomedical_intra_industry_packaged_value,0),
                            bc_packaged_intra_industry_extracts_value = COALESCE(extracts_bc_nomedical_intra_industry_packaged_value,0),
                            mb_packaged_intra_industry_extracts_value = COALESCE(extracts_mb_nomedical_intra_industry_packaged_value,0),
                            nb_packaged_intra_industry_extracts_value = COALESCE(extracts_nb_nomedical_intra_industry_packaged_value,0), 
                            nl_packaged_intra_industry_extracts_value = COALESCE(extracts_nl_nomedical_intra_industry_packaged_value,0), 
                            ns_packaged_intra_industry_extracts_value = COALESCE(extracts_ns_nomedical_intra_industry_packaged_value,0),
                            nt_packaged_intra_industry_extracts_value = COALESCE(extracts_nt_nomedical_intra_industry_packaged_value,0),
                            nu_packaged_intra_industry_extracts_value = COALESCE(extracts_nu_nomedical_intra_industry_packaged_value,0),
                            on_packaged_intra_industry_extracts_value = COALESCE(extracts_on_nomedical_intra_industry_packaged_value,0),
                            pe_packaged_intra_industry_extracts_value = COALESCE(extracts_pe_nomedical_intra_industry_packaged_value,0),
                            qc_packaged_intra_industry_extracts_value = COALESCE(extracts_qc_nomedical_intra_industry_packaged_value,0), 
                            sk_packaged_intra_industry_extracts_value = COALESCE(extracts_sk_nomedical_intra_industry_packaged_value,0),
                            yt_packaged_intra_industry_extracts_value = COALESCE(extracts_yt_nomedical_intra_industry_packaged_value,0), 
                            total_packaged_intra_industry_extracts_value = COALESCE(extracts_total_nomedical_intra_industry_packaged_value,0)
                            
                        FROM (
                            SELECT
                            -- seeds distributor
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_distributor') as seeds_ab_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_distributor') as seeds_bc_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_distributor') as seeds_mb_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_distributor') as seeds_nb_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_distributor') as seeds_nl_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_distributor') as seeds_ns_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_distributor') as seeds_nt_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_distributor') as seeds_nu_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_distributor') as seeds_on_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_distributor') as seeds_pe_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_distributor') as seeds_qc_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_distributor') as seeds_sk_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_distributor') as seeds_yt_nomedical_distributor,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.type = 'nonmedical_distributor') as seeds_total_nomedical_distributor,
                            
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_distributor') as seeds_ab_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_distributor') as seeds_bc_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_distributor') as seeds_mb_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_distributor') as seeds_nb_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_distributor') as seeds_nl_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_distributor') as seeds_ns_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_distributor') as seeds_nt_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_distributor') as seeds_nu_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_distributor') as seeds_on_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_distributor') as seeds_pe_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_distributor') as seeds_qc_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_distributor') as seeds_sk_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_distributor') as seeds_yt_nomedical_distributor_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.type = 'nonmedical_distributor') as seeds_total_nomedical_distributor_value,

                            -- seeds recreational consumer
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_recreational_consumer') as seeds_ab_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_recreational_consumer') as seeds_bc_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_recreational_consumer') as seeds_mb_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_recreational_consumer') as seeds_nb_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_recreational_consumer') as seeds_nl_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_recreational_consumer') as seeds_ns_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_recreational_consumer') as seeds_nt_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_recreational_consumer') as seeds_nu_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_recreational_consumer') as seeds_on_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_recreational_consumer') as seeds_pe_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_recreational_consumer') as seeds_qc_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_recreational_consumer') as seeds_sk_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_recreational_consumer') as seeds_yt_nomedical_recreational_consumer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.type = 'nonmedical_recreational_consumer') as seeds_total_nomedical_recreational_consumer,
                            
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_recreational_consumer') as seeds_ab_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_recreational_consumer') as seeds_bc_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_recreational_consumer') as seeds_mb_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_recreational_consumer') as seeds_nb_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_recreational_consumer') as seeds_nl_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_recreational_consumer') as seeds_ns_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_recreational_consumer') as seeds_nt_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_recreational_consumer') as seeds_nu_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_recreational_consumer') as seeds_on_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_recreational_consumer') as seeds_pe_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_recreational_consumer') as seeds_qc_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_recreational_consumer') as seeds_sk_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_recreational_consumer') as seeds_yt_nomedical_recreational_consumer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.type = 'nonmedical_recreational_consumer') as seeds_total_nomedical_recreational_consumer_value,

                            -- seeds retailer
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_retailer') as seeds_ab_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_retailer') as seeds_bc_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_retailer') as seeds_mb_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_retailer') as seeds_nb_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_retailer') as seeds_nl_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_retailer') as seeds_ns_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_retailer') as seeds_nt_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_retailer') as seeds_nu_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_retailer') as seeds_on_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_retailer') as seeds_pe_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_retailer') as seeds_qc_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_retailer') as seeds_sk_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_retailer') as seeds_yt_nomedical_retailer,
                            SUM(T3.seeds_qty) FILTER (WHERE T3.type = 'nonmedical_retailer') as seeds_total_nomedical_retailer,
                            
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_retailer') as seeds_ab_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_retailer') as seeds_bc_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_retailer') as seeds_mb_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_retailer') as seeds_nb_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_retailer') as seeds_nl_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_retailer') as seeds_ns_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_retailer') as seeds_nt_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_retailer') as seeds_nu_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_retailer') as seeds_on_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_retailer') as seeds_pe_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_retailer') as seeds_qc_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_retailer') as seeds_sk_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_retailer') as seeds_yt_nomedical_retailer_value,
                            SUM(T3.seeds_qty_value) FILTER (WHERE T3.type = 'nonmedical_retailer') as seeds_total_nomedical_retailer_value,

                            -- plants distributor
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_distributor') as plants_ab_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_distributor') as plants_bc_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_distributor') as plants_mb_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_distributor') as plants_nb_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_distributor') as plants_nl_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_distributor') as plants_ns_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_distributor') as plants_nt_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_distributor') as plants_nu_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_distributor') as plants_on_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_distributor') as plants_pe_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_distributor') as plants_qc_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_distributor') as plants_sk_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_distributor') as plants_yt_nomedical_distributor,
                            SUM(T3.plants_qty) FILTER (WHERE T3.type = 'nonmedical_distributor') as plants_total_nomedical_distributor,
                            
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_distributor') as plants_ab_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_distributor') as plants_bc_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_distributor') as plants_mb_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_distributor') as plants_nb_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_distributor') as plants_nl_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_distributor') as plants_ns_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_distributor') as plants_nt_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_distributor') as plants_nu_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_distributor') as plants_on_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_distributor') as plants_pe_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_distributor') as plants_qc_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_distributor') as plants_sk_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_distributor') as plants_yt_nomedical_distributor_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.type = 'nonmedical_distributor') as plants_total_nomedical_distributor_value,

                            -- plants recreational consumer
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_recreational_consumer') as plants_ab_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_recreational_consumer') as plants_bc_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_recreational_consumer') as plants_mb_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_recreational_consumer') as plants_nb_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_recreational_consumer') as plants_nl_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_recreational_consumer') as plants_ns_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_recreational_consumer') as plants_nt_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_recreational_consumer') as plants_nu_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_recreational_consumer') as plants_on_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_recreational_consumer') as plants_pe_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_recreational_consumer') as plants_qc_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_recreational_consumer') as plants_sk_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_recreational_consumer') as plants_yt_nomedical_recreational_consumer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.type = 'nonmedical_recreational_consumer') as plants_total_nomedical_recreational_consumer,
                            
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_recreational_consumer') as plants_ab_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_recreational_consumer') as plants_bc_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_recreational_consumer') as plants_mb_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_recreational_consumer') as plants_nb_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_recreational_consumer') as plants_nl_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_recreational_consumer') as plants_ns_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_recreational_consumer') as plants_nt_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_recreational_consumer') as plants_nu_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_recreational_consumer') as plants_on_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_recreational_consumer') as plants_pe_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_recreational_consumer') as plants_qc_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_recreational_consumer') as plants_sk_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_recreational_consumer') as plants_yt_nomedical_recreational_consumer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.type = 'nonmedical_recreational_consumer') as plants_total_nomedical_recreational_consumer_value,

                            -- plants retailer
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_retailer') as plants_ab_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_retailer') as plants_bc_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_retailer') as plants_mb_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_retailer') as plants_nb_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_retailer') as plants_nl_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_retailer') as plants_ns_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_retailer') as plants_nt_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_retailer') as plants_nu_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_retailer') as plants_on_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_retailer') as plants_pe_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_retailer') as plants_qc_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_retailer') as plants_sk_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_retailer') as plants_yt_nomedical_retailer,
                            SUM(T3.plants_qty) FILTER (WHERE T3.type = 'nonmedical_retailer') as plants_total_nomedical_retailer,
                            
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_retailer') as plants_ab_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_retailer') as plants_bc_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_retailer') as plants_mb_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_retailer') as plants_nb_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_retailer') as plants_nl_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_retailer') as plants_ns_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_retailer') as plants_nt_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_retailer') as plants_nu_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_retailer') as plants_on_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_retailer') as plants_pe_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_retailer') as plants_qc_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_retailer') as plants_sk_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_retailer') as plants_yt_nomedical_retailer_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.type = 'nonmedical_retailer') as plants_total_nomedical_retailer_value,

                            -- plants intra industry
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_ab_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_bc_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_mb_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_nb_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_nl_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_ns_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_nt_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_nu_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_on_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_pe_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_qc_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_sk_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_yt_nomedical_intra_industry_unpackaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_total_nomedical_intra_industry_unpackaged,
                        
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_ab_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_bc_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_mb_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_nb_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_nl_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_ns_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_nt_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_nu_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_on_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_pe_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_qc_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_sk_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_yt_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as plants_total_nomedical_intra_industry_unpackaged_value,

                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_ab_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_bc_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_mb_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_nb_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_nl_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_ns_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_nt_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_nu_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_on_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_pe_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_qc_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_sk_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_yt_nomedical_intra_industry_packaged,
                            SUM(T3.plants_qty) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_total_nomedical_intra_industry_packaged,
                            
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_ab_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_bc_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_mb_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_nb_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_nl_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_ns_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_nt_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_nu_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_on_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_pe_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_qc_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_sk_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_yt_nomedical_intra_industry_packaged_value,
                            SUM(T3.plants_qty_value) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as plants_total_nomedical_intra_industry_packaged_value,

                            -- fresh_cannabis distributor
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_ab_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_bc_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_mb_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_nb_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_nl_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_ns_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_nt_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_nu_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_on_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_pe_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_qc_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_sk_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_yt_nomedical_distributor,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.type = 'nonmedical_distributor') as fresh_cannabis_total_nomedical_distributor,
                            
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_ab_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_bc_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_mb_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_nb_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_nl_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_ns_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_nt_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_nu_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_on_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_pe_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_qc_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_sk_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_distributor') as fresh_cannabis_yt_nomedical_distributor_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.type = 'nonmedical_distributor') as fresh_cannabis_total_nomedical_distributor_value,

                            -- fresh_cannabis recreational consumer
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_ab_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_bc_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_mb_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_nb_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_nl_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_ns_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_nt_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_nu_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_on_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_pe_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_qc_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_sk_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_yt_nomedical_recreational_consumer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_total_nomedical_recreational_consumer,
                            
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_ab_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_bc_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_mb_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_nb_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_nl_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_ns_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_nt_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_nu_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_on_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_pe_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_qc_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_sk_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_yt_nomedical_recreational_consumer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.type = 'nonmedical_recreational_consumer') as fresh_cannabis_total_nomedical_recreational_consumer_value,

                            -- fresh_cannabis retailer
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_ab_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_bc_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_mb_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_nb_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_nl_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_ns_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_nt_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_nu_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_on_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_pe_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_qc_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_sk_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_yt_nomedical_retailer,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.type = 'nonmedical_retailer') as fresh_cannabis_total_nomedical_retailer,
                            
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_ab_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_bc_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_mb_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_nb_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_nl_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_ns_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_nt_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_nu_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_on_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_pe_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_qc_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_sk_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_retailer') as fresh_cannabis_yt_nomedical_retailer_value,
                            SUM(T3.fresh_cannabis_qty_value) FILTER (WHERE T3.type = 'nonmedical_retailer') as fresh_cannabis_total_nomedical_retailer_value,

                            -- fresh_cannabis intra industry
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_ab_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_bc_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_mb_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_nb_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_nl_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_ns_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_nt_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_nu_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_on_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_pe_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_qc_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_sk_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_yt_nomedical_intra_industry_unpackaged,
                            SUM(T3.fresh_cannabis_weight) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_total_nomedical_intra_industry_unpackaged,
                            
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_ab_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_bc_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_mb_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_nb_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_nl_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_ns_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_nt_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_nu_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_on_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_pe_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_qc_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_sk_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_yt_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as fresh_cannabis_total_nomedical_intra_industry_unpackaged_value,

                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged' AND T3.sku_type = 'packaged') as fresh_cannabis_ab_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_bc_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_mb_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_nb_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_nl_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_ns_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_nt_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_nu_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_on_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_pe_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_qc_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_sk_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_yt_nomedical_intra_industry_packaged,
                            SUM(T3.fresh_cannabis_qty) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_total_nomedical_intra_industry_packaged,
                            
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_ab_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_bc_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_mb_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_nb_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_nl_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_ns_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_nt_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_nu_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_on_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_pe_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_qc_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_sk_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_yt_nomedical_intra_industry_packaged_value,
                            SUM(T3.fresh_cannabis_weight_value) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as fresh_cannabis_total_nomedical_intra_industry_packaged_value,

                            -- dried cannabis distributor
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_distributor') as dried_cannabis_ab_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_distributor') as dried_cannabis_bc_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_distributor') as dried_cannabis_mb_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_distributor') as dried_cannabis_nb_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_distributor') as dried_cannabis_nl_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_distributor') as dried_cannabis_ns_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_distributor') as dried_cannabis_nt_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_distributor') as dried_cannabis_nu_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_distributor') as dried_cannabis_on_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_distributor') as dried_cannabis_pe_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_distributor') as dried_cannabis_qc_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_distributor') as dried_cannabis_sk_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_distributor') as dried_cannabis_yt_nomedical_distributor,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.type = 'nonmedical_distributor') as dried_cannabis_total_nomedical_distributor,
                            
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_distributor') as dried_cannabis_ab_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_distributor') as dried_cannabis_bc_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_distributor') as dried_cannabis_mb_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_distributor') as dried_cannabis_nb_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_distributor') as dried_cannabis_nl_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_distributor') as dried_cannabis_ns_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_distributor') as dried_cannabis_nt_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_distributor') as dried_cannabis_nu_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_distributor') as dried_cannabis_on_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_distributor') as dried_cannabis_pe_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_distributor') as dried_cannabis_qc_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_distributor') as dried_cannabis_sk_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_distributor') as dried_cannabis_yt_nomedical_distributor_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.type = 'nonmedical_distributor') as dried_cannabis_total_nomedical_distributor_value,

                            -- dried cannabis recreational consumer
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_ab_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_bc_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_mb_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_nb_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_nl_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_ns_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_nt_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_nu_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_on_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_pe_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_qc_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_sk_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_yt_nomedical_recreational_consumer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_total_nomedical_recreational_consumer,
                            
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_ab_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_bc_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_mb_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_nb_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_nl_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_ns_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_nt_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_nu_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_on_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_pe_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_qc_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_sk_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_yt_nomedical_recreational_consumer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.type = 'nonmedical_recreational_consumer') as dried_cannabis_total_nomedical_recreational_consumer_value,

                            -- dried_cannabis retailer
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_retailer') as dried_cannabis_ab_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_retailer') as dried_cannabis_bc_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_retailer') as dried_cannabis_mb_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_retailer') as dried_cannabis_nb_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_retailer') as dried_cannabis_nl_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_retailer') as dried_cannabis_ns_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_retailer') as dried_cannabis_nt_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_retailer') as dried_cannabis_nu_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_retailer') as dried_cannabis_on_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_retailer') as dried_cannabis_pe_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_retailer') as dried_cannabis_qc_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_retailer') as dried_cannabis_sk_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_retailer') as dried_cannabis_yt_nomedical_retailer,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.type = 'nonmedical_retailer') as dried_cannabis_total_nomedical_retailer,
                            
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_retailer') as dried_cannabis_ab_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_retailer') as dried_cannabis_bc_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_retailer') as dried_cannabis_mb_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_retailer') as dried_cannabis_nb_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_retailer') as dried_cannabis_nl_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_retailer') as dried_cannabis_ns_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_retailer') as dried_cannabis_nt_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_retailer') as dried_cannabis_nu_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_retailer') as dried_cannabis_on_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_retailer') as dried_cannabis_pe_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_retailer') as dried_cannabis_qc_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_retailer') as dried_cannabis_sk_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_retailer') as dried_cannabis_yt_nomedical_retailer_value,
                            SUM(T3.dried_cannabis_qty_value) FILTER (WHERE T3.type = 'nonmedical_retailer') as dried_cannabis_total_nomedical_retailer_value,

                            -- dried_cannabis intra industry
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_ab_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_bc_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_mb_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_nb_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_nl_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_ns_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_nt_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_nu_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_on_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_pe_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_qc_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_sk_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_yt_nomedical_intra_industry_unpackaged,
                            SUM(T3.dried_cannabis_weight) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_total_nomedical_intra_industry_unpackaged,
                            
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_ab_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_bc_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_mb_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_nb_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_nl_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_ns_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_nt_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_nu_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_on_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_pe_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_qc_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_sk_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_yt_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as dried_cannabis_total_nomedical_intra_industry_unpackaged_value,

                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_ab_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_bc_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_mb_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_nb_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_nl_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_ns_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_nt_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_nu_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_on_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_pe_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_qc_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_sk_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_yt_nomedical_intra_industry_packaged,
                            SUM(T3.dried_cannabis_qty) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_total_nomedical_intra_industry_packaged,
                            
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_ab_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_bc_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_mb_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_nb_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_nl_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_ns_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_nt_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_nu_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_on_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_pe_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_qc_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_sk_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_yt_nomedical_intra_industry_packaged_value,
                            SUM(T3.dried_cannabis_weight_value) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as dried_cannabis_total_nomedical_intra_industry_packaged_value,

                            -- extracts distributor
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_distributor') as extracts_ab_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_distributor') as extracts_bc_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_distributor') as extracts_mb_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_distributor') as extracts_nb_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_distributor') as extracts_nl_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_distributor') as extracts_ns_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_distributor') as extracts_nt_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_distributor') as extracts_nu_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_distributor') as extracts_on_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_distributor') as extracts_pe_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_distributor') as extracts_qc_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_distributor') as extracts_sk_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_distributor') as extracts_yt_nomedical_distributor,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.type = 'nonmedical_distributor') as extracts_total_nomedical_distributor,
                            
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_distributor') as extracts_ab_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_distributor') as extracts_bc_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_distributor') as extracts_mb_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_distributor') as extracts_nb_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_distributor') as extracts_nl_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_distributor') as extracts_ns_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_distributor') as extracts_nt_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_distributor') as extracts_nu_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_distributor') as extracts_on_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_distributor') as extracts_pe_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_distributor') as extracts_qc_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_distributor') as extracts_sk_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_distributor') as extracts_yt_nomedical_distributor_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.type = 'nonmedical_distributor') as extracts_total_nomedical_distributor_value,

                            -- dried cannabis recreational consumer
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_recreational_consumer') as extracts_ab_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_recreational_consumer') as extracts_bc_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_recreational_consumer') as extracts_mb_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_recreational_consumer') as extracts_nb_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_recreational_consumer') as extracts_nl_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_recreational_consumer') as extracts_ns_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_recreational_consumer') as extracts_nt_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_recreational_consumer') as extracts_nu_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_recreational_consumer') as extracts_on_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_recreational_consumer') as extracts_pe_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_recreational_consumer') as extracts_qc_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_recreational_consumer') as extracts_sk_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_recreational_consumer') as extracts_yt_nomedical_recreational_consumer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.type = 'nonmedical_recreational_consumer') as extracts_total_nomedical_recreational_consumer,

                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_recreational_consumer') as extracts_ab_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_recreational_consumer') as extracts_bc_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_recreational_consumer') as extracts_mb_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_recreational_consumer') as extracts_nb_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_recreational_consumer') as extracts_nl_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_recreational_consumer') as extracts_ns_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_recreational_consumer') as extracts_nt_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_recreational_consumer') as extracts_nu_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_recreational_consumer') as extracts_on_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_recreational_consumer') as extracts_pe_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_recreational_consumer') as extracts_qc_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_recreational_consumer') as extracts_sk_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_recreational_consumer') as extracts_yt_nomedical_recreational_consumer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.type = 'nonmedical_recreational_consumer') as extracts_total_nomedical_recreational_consumer_value,

                            -- extracts retailer
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_retailer') as extracts_ab_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_retailer') as extracts_bc_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_retailer') as extracts_mb_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_retailer') as extracts_nb_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_retailer') as extracts_nl_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_retailer') as extracts_ns_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_retailer') as extracts_nt_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_retailer') as extracts_nu_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_retailer') as extracts_on_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_retailer') as extracts_pe_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_retailer') as extracts_qc_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_retailer') as extracts_sk_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_retailer') as extracts_yt_nomedical_retailer,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.type = 'nonmedical_retailer') as extracts_total_nomedical_retailer,

                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'nonmedical_retailer') as extracts_ab_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'nonmedical_retailer') as extracts_bc_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'nonmedical_retailer') as extracts_mb_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'nonmedical_retailer') as extracts_nb_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'nonmedical_retailer') as extracts_nl_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'nonmedical_retailer') as extracts_ns_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'nonmedical_retailer') as extracts_nt_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'nonmedical_retailer') as extracts_nu_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'nonmedical_retailer') as extracts_on_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'nonmedical_retailer') as extracts_pe_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'nonmedical_retailer') as extracts_qc_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'nonmedical_retailer') as extracts_sk_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'nonmedical_retailer') as extracts_yt_nomedical_retailer_value,
                            SUM(T3.extracts_qty_value) FILTER (WHERE T3.type = 'nonmedical_retailer') as extracts_total_nomedical_retailer_value,

                            -- extracts intra industry
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_ab_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_bc_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_mb_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_nb_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_nl_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_ns_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_nt_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_nu_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_on_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_pe_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_qc_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_sk_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_yt_nomedical_intra_industry_unpackaged,
                            SUM(T3.extracts_weight) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_total_nomedical_intra_industry_unpackaged,
                            
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_ab_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_bc_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_mb_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_nb_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_nl_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_ns_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_nt_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_nu_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_on_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_pe_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_qc_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_sk_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_yt_nomedical_intra_industry_unpackaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'unpackaged') as extracts_total_nomedical_intra_industry_unpackaged_value,

                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_ab_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_bc_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_mb_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_nb_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_nl_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_ns_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_nt_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_nu_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_on_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_pe_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_qc_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_sk_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_yt_nomedical_intra_industry_packaged,
                            SUM(T3.extracts_qty) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_total_nomedical_intra_industry_packaged,
                            
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'AB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_ab_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'BC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_bc_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'MB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_mb_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'NB' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_nb_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'NL' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_nl_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'NS' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_ns_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'NT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_nt_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'NU' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_nu_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'ON' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_on_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'PE' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_pe_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'QC' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_qc_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'SK' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_sk_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.province = 'YT' AND T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_yt_nomedical_intra_industry_packaged_value,
                            SUM(T3.extracts_weight_value) FILTER (WHERE T3.type = 'intra_industry' AND T3.sku_type = 'packaged') as extracts_total_nomedical_intra_industry_packaged_value
                        FROM (
                                SELECT
                                    SUM(T2.seeds_qty) as seeds_qty,
                                    SUM(T2.plants_qty) as plants_qty,
                                    SUM(T2.fresh_cannabis_qty) as fresh_cannabis_qty,
                                    SUM(T2.dried_cannabis_qty) as dried_cannabis_qty,
                                    SUM(T2.extracts_qty) as extracts_qty,
                                    SUM(T2.fresh_cannabis_weight)/1000 as fresh_cannabis_weight,
                                    SUM(T2.dried_cannabis_weight)/1000 as dried_cannabis_weight,
                                    SUM(T2.extracts_weight)/1000 as extracts_weight,

                                    SUM(seeds_qty_value) AS seeds_qty_value,
                                    SUM(plants_qty_value) AS plants_qty_value,
                                    SUM(fresh_cannabis_qty_value) AS fresh_cannabis_qty_value,
                                    SUM(dried_cannabis_qty_value) AS dried_cannabis_qty_value,
                                    SUM(extracts_qty_value) AS extracts_qty_value,
                                    SUM(fresh_cannabis_weight_value) AS fresh_cannabis_weight_value,
                                    SUM(dried_cannabis_weight_value) AS dried_cannabis_weight_value,
                                    SUM(extracts_weight_value) AS extracts_weight_value,

                                    T2.province,
                                    T2.type,
                                    SUM(T2.total),
                                    T2.sku_type
                                FROM(
                                    SELECT T0.*,
                                            CASE
                                                WHEN T0.seeds_qty > 0 THEN T0.total
                                                ELSE 0
                                            END AS seeds_qty_value,
                                            CASE
                                                WHEN T0.plants_qty > 0 THEN T0.total
                                                ELSE 0
                                            END AS plants_qty_value,
                                            CASE
                                                WHEN T0.fresh_cannabis_qty > 0 THEN T0.total
                                                ELSE 0
                                            END AS fresh_cannabis_qty_value,
                                            CASE
                                                WHEN T0.dried_cannabis_qty > 0 THEN T0.total
                                                ELSE 0
                                            END AS dried_cannabis_qty_value,
                                            CASE
                                                WHEN T0.extracts_qty > 0 THEN T0.total
                                                ELSE 0
                                            END AS extracts_qty_value,
                                            CASE
                                                WHEN T0.fresh_cannabis_weight > 0 THEN T0.total
                                                ELSE 0
                                            END AS fresh_cannabis_weight_value,
                                            CASE
                                                WHEN T0.dried_cannabis_weight > 0 THEN T0.total
                                                ELSE 0
                                            END AS dried_cannabis_weight_value,
                                            CASE
                                                WHEN T0.extracts_weight> 0 THEN T0.total
                                                ELSE 0
                                            END AS extracts_weight_value	
                                    FROM (
                                        SELECT
                                            CASE
                                                WHEN (f).seeds > 0 THEN T1.quantity
                                                ELSE 0
                                                END AS seeds_qty,
                                            CASE
                                                WHEN (f).plants > 0 THEN T1.quantity
                                                ELSE 0
                                                END AS plants_qty,
                                            CASE
                                                WHEN (f).gwet > 0 THEN T1.quantity
                                                ELSE 0
                                                END AS fresh_cannabis_qty,
                                            CASE
                                                WHEN ((f).dry + (f).cured) > 0 THEN T1.quantity
                                                ELSE 0
                                                END AS dried_cannabis_qty,
                                            CASE
                                                WHEN ((f).crude + (f).distilled) > 0 THEN T1.quantity
                                                ELSE 0
                                            END AS extracts_qty,
                                            (f).gwet AS fresh_cannabis_weight,
                                            ((f).dry + (f).cured) AS dried_cannabis_weight,
                                            ((f).crude + (f).distilled) AS extracts_weight,
                                            T1.*,
                                            CASE
                                                WHEN T1.account_type = 'patient' THEN 'medical_consumer'
                                                WHEN T1.account_type = 'retailer' THEN 'nonmedical_retailer'
                                                WHEN T1.account_type = 'distributor' THEN 'nonmedical_distributor'                               
                                                WHEN T1.account_type in ('licence holder', 'researcher') THEN 'intra_industry'
                                                WHEN T1.account_type = 'recreational consumer' THEN 'nonmedical_recreational_consumer'
                                            END AS type
                                        FROM (
                                            SELECT f_serialize_stats_fields_accounts(oi.ordered_stats) AS f,
                                                oi.quantity, o.shipping_address->>'province' AS province,
                                                TRIM(REPLACE(CAST(crm.account_type AS VARCHAR), '"', '')) as account_type,
                                                oi.price + oi.provincial_tax + oi.shipping_value - oi.discount as total,
                                                o.id, 
                                                COALESCE(oi.sku_type, 'unpackaged') as sku_type
                                            FROM orders AS o
                                                INNER JOIN (
                                                    SELECT order_items.*, sku.data->>'type' as sku_type FROM order_items as order_items
                                                    INNER JOIN skus as sku ON order_items.sku_id = sku.id
                                                    LEFT JOIN (SELECT * FROM activities WHERE activities.name='order_cancel_item') AS activities ON order_items.id=CAST(activities.data->>'order_item_id' as INTEGER)
                                                    WHERE activities.data->>'order_item_id' IS null) AS oi ON oi.order_id = o.id
                                                INNER JOIN crm_accounts AS crm ON crm.id = o.crm_account_id
                                                INNER JOIN (
                                                        SELECT 
                                                            id,
                                                            shipping_address,
                                                            order_received_date,
                                                            ordered_stats,
                                                            organization_id,
                                                            order_type,
                                                            status
                                                        FROM orders WHERE status='approved' AND
                                                            organization_id = org_id AND
                                                            LEFT(data->>'payment_date',10) between initial_date and final_date
                                                            AND status = 'approved'

                                                        UNION ALL

                                                        SELECT
                                                            b.id,
                                                            b.shipping_address,
                                                            b.order_received_date,
                                                            b.ordered_stats,
                                                            b.organization_id,
                                                            b.order_type,
                                                            b.status
                                                        FROM (SELECT * FROM orders WHERE status='cancelled' AND LEFT(data->>'payment_date',10) between initial_date and final_date) AS b
                                                        INNER JOIN (SELECT *
                                                            from activities
                                                            WHERE
                                                                name = 'order_update_status' AND
                                                                data->>'to_status' = 'cancelled' AND
                                                                TO_CHAR(timestamp,'YYYY-MM-DD') > final_date
                                                                ) AS a ON b.id = CAST(a.data->>'order_id' AS INTEGER)
                                                ) AS order_status ON order_status.id = o.id

                                        ) AS T1
                                    ) AS T0
                                ) AS T2
                                GROUP BY T2.province, T2.type, T2.sku_type

                            ) AS T3
                        ) AS T4
                        WHERE id = report_id;

                            
                        END;$function$
            ;

        """
    )
